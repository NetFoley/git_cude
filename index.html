<!DOCTYPE html>
<html>

<!-- Toutes les balises d'entÃªte -->
<head name="head">
	<!-- Encodage de la page -->
	<meta charset="utf-8" lang="fr"/>
	<!-- Nom de la page -->
	<title>Dom navigation</title>
	<!-- Lien vers le fichier de style CSS -->
	<link type="text/css" rel="stylesheet" href="style.css"/>
	<!-- Code JavaScript de la page -->
	<script src="../../JS/PremierScript.js"></script>
	<!-- Image onglet  -->
	<link rel="shortcut icon" type ="image/x-icon" href="../../images/decarboneNon.png"/>
</head>
<!--Contenu de le page-->
<body>
<style>
.slider {
  -webkit-appearance: none;
  width: 150px;
  height: 25px;
  background: #d3d3d3;
  outline: none;
  opacity: 0.7;
  -webkit-transition: .2s;
  transition: opacity .2s;
}

.slider:hover {
  opacity: 1;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 25px;
  height: 25px;
  background: #4CAF50;
  cursor: pointer;
}

.slider::-moz-range-thumb {
  width: 25px;
  height: 25px;
  background: #4CAF50;
  cursor: pointer;
}
</style>
	<!-- Haut de la page -->
	<header>
	<h1>Type fast</h1>
	<input type="text" oninput="checkRemove(this, event)" onkeydown="checkRemove(this, event)" onmousedown="checkRemove(this, event)">
	<input type="range" class="slider" onchange="init(this.value)" min = 1 max = 5>
	<p id="average">0</p>
	<p id="averageChars">0</p>
	<p id="combo">0</p>
	<p id="score">0</p>
	</header>
	
	<!-- Corps de la page  -->
	<blockquote>
	<div id="div" style="width: 500px"></div>
	</blockquote>
	
	<!-- Pas de la page  -->
	<footer>
	
	</footer>
<script>
let words = ['a','ability','able','about','above','accept','according','account','across','act','action','activity','actually','add','address','administration','admit','adult','affect','after','again','against','age','agency','agent','ago','agree','agreement','ahead','air','all','allow','almost','alone','along','already','also','although','always','American','among','amount','analysis','and','animal','another','answer','any','anyone','anything','appear','apply','approach','area','argue','arm','around','arrive','art','article','artist','as','ask','assume','at','attack','attention','attorney','audience','author','authority','available','avoid','away','baby','back','bad','bag','ball','bank','bar','base','be','beat','beautiful','because','become','bed','before','begin','behavior','behind','believe','benefit','best','better','between','beyond','big','bill','billion','bit','black','blood','blue','board','body','book','born','both','box','boy','break','bring','brother','budget','build','building','business','but','buy','by','call','camera','campaign','can','cancer','candidate','capital','car','card','care','career','carry','case','catch','cause','cell','center','central','century','certain','certainly','chair','challenge','chance','change','character','charge','check','child','choice','choose','church','citizen','city','civil','claim','class','clear','clearly','close','coach','cold','collection','college','color','come','commercial','common','community','company','compare','computer','concern','condition','conference','Congress','consider','consumer','contain','continue','control','cost','could','country','couple','course','court','cover','create','crime','cultural','culture','cup','current','customer','cut','dark','data','daughter','day','dead','deal','death','debate','decade','decide','decision','deep','defense','degree','Democrat','democratic','describe','design','despite','detail','determine','develop','development','die','difference','different','difficult','dinner','direction','director','discover','discuss','discussion','disease','do','doctor','dog','door','down','draw','dream','drive','drop','drug','during','each','early','east','easy','eat','economic','economy','edge','education','effect','effort','eight','either','election','else','employee','end','energy','enjoy','enough','enter','entire','environment','environmental','especially','establish','even','evening','event','ever','every','everybody','everyone','everything','evidence','exactly','example','executive','exist','expect','experience','expert','explain','eye','face','fact','factor','fail','fall','family','far','fast','father','fear','federal','feel','feeling','few','field','fight','figure','fill','film','final','finally','financial','find','fine','finger','finish','fire','firm','first','fish','five','floor','fly','focus','follow','food','foot','for','force','foreign','forget','form','former','forward','four','free','friend','from','front','full','fund','future','game','garden','gas','general','generation','get','girl','give','glass','go','goal','good','government','great','green','ground','group','grow','growth','guess','gun','guy','hair','half','hand','hang','happen','happy','hard','have','he','head','health','hear','heart','heat','heavy','help','her','here','herself','high','him','himself','his','history','hit','hold','home','hope','hospital','hot','hotel','hour','house','how','however','huge','human','hundred','husband','I','idea','identify','if','image','imagine','impact','important','improve','in','include','including','increase','indeed','indicate','individual','industry','information','inside','instead','institution','interest','interesting','international','interview','into','investment','involve','issue','it','item','its','itself','job','join','just','keep','key','kid','kill','kind','kitchen','know','knowledge','land','language','large','last','late','later','laugh','law','lawyer','lay','lead','leader','learn','least','leave','left','leg','legal','less','let','letter','level','lie','life','light','like','likely','line','list','listen','little','live','local','long','look','lose','loss','lot','love','low','machine','magazine','main','maintain','major','majority','make','man','manage','management','manager','many','market','marriage','material','matter','may','maybe','me','mean','measure','media','medical','meet','meeting','member','memory','mention','message','method','middle','might','military','million','mind','minute','miss','mission','model','modern','moment','money','month','more','morning','most','mother','mouth','move','movement','movie','Mr','Mrs','much','music','must','my','myself','name','nation','national','natural','nature','near','nearly','necessary','need','network','never','new','news','newspaper','next','nice','night','no','none','nor','north','not','note','nothing','notice','now','n','t','number','occur','of','off','offer','office','officer','official','often','oh','oil','ok','old','on','once','one','only','onto','open','operation','opportunity','option','or','order','organization','other','others','our','out','outside','over','own','owner','page','pain','painting','paper','parent','part','participant','particular','particularly','partner','party','pass','past','patient','pattern','pay','peace','people','per','perform','performance','perhaps','period','person','personal','phone','physical','pick','picture','piece','place','plan','plant','play','player','PM','point','police','policy','political','politics','poor','popular','population','position','positive','possible','power','practice','prepare','present','president','pressure','pretty','prevent','price','private','probably','problem','process','produce','product','production','professional','professor','program','project','property','protect','prove','provide','public','pull','purpose','push','put','quality','question','quickly','quite','race','radio','raise','range','rate','rather','reach','read','ready','real','reality','realize','really','reason','receive','recent','recently','recognize','record','red','reduce','reflect','region','relate','relationship','religious','remain','remember','remove','report','represent','Republican','require','research','resource','respond','response','responsibility','rest','result','return','reveal','rich','right','rise','risk','road','rock','role','room','rule','run','safe','same','save','say','scene','school','science','scientist','score','sea','season','seat','second','section','security','see','seek','seem','sell','send','senior','sense','series','serious','serve','service','set','seven','several','sex','sexual','shake','share','she','shoot','short','shot','should','shoulder','show','side','sign','significant','similar','simple','simply','since','sing','single','sister','sit','site','situation','six','size','skill','skin','small','smile','so','social','society','soldier','some','somebody','someone','something','sometimes','son','song','soon','sort','sound','source','south','southern','space','speak','special','specific','speech','spend','sport','spring','staff','stage','stand','standard','star','start','state','statement','station','stay','step','still','stock','stop','store','story','strategy','street','strong','structure','student','study','stuff','style','subject','success','successful','such','suddenly','suffer','suggest','summer','support','sure','surface','system','table','take','talk','task','tax','teach','teacher','team','technology','television','tell','ten','tend','term','test','than','thank','that','the','their','them','themselves','then','theory','there','these','they','thing','think','third','this','those','though','thought','thousand','threat','three','through','throughout','throw','thus','time','to','today','together','tonight','too','top','total','tough','toward','town','trade','traditional','training','travel','treat','treatment','tree','trial','trip','trouble','true','truth','try','turn','TV','two','type','under','understand','unit','until','up','upon','us','use','usually','value','various','very','victim','view','violence','visit','voice','vote','wait','walk','wall','want','war','watch','water','way','we','weapon','wear','week','weight','well','west','western','what','whatever','when','where','whether','which','while','white','who','whole','whom','whose','why','wide','wife','will','win','wind','window','wish','with','within','without','woman','wonder','word','work','worker','world','worry','would','write','writer','wrong','yard','yeah','year','yes','yet','you','young','your','yourself'];
</script>
<script>
	let i = 0;
	let displayScore = 0;
	let score = 0;
	let deadI = 0;
	let deadIChars = 0;
	let startTime = 1;
	let maxI = 0;
	let value = 1;
	let combo = 0;
	let inter = undefined;
	init(document.getElementsByClassName("slider")[0].value);
	
	
	function init(newValue)
	{
		if(inter != undefined)
		{
			clearInterval(inter)
			inter = undefined;
		}
		value = newValue;
		displayScore = 0;
		score = 0;
		i = 0;
		deadI = 0;
		deadIChars = 0;
		combo = 0;
		startTime = new Date().getTime();
		maxI = 0;
		updateAverage();
		document.getElementById("div").innerHTML = "";
		document.getElementById("div").append(getButton("kaboom", 280, 100, 300));
	}
	
	function draw()
	{
		i = 0;
		let but = document.getElementById(String(i));
		updateAverage();
		let noOneFound = true;
		while(i <= maxI)
		{
			if(but)
			{
				noOneFound = false;
				but.style.left = parseFloat(but.style.left) + value/3 + "px";
				j = 0;
				while(j <= maxI)
				{
					if(i == j)
						break;
						
						
					let but2 = document.getElementById(String(j));
					if(but2)
					{
						if(collide(but, but2) || parseInt(but.style.top) < 0)
						{
							repel(but, but2);
						}
					}
					j++;
				}
			}
			i++;
			but = document.getElementById(String(i));
		}
		if(noOneFound)
			clearInterval(inter);
		if(combo > 0.01)
			combo -= 0.01;
		displayScore = displayScore + (score - displayScore)/25;
	}
	
	function collide(but1, but2)
	{
		let dist = Math.abs(parseInt(but1.style.left) - parseInt(but2.style.left)) + Math.abs( parseInt(but1.style.top) -  parseInt(but2.style.top));
		if(dist < parseInt(but1.style.minWidth) || dist < parseInt(but2.style.minWidth))
			if(parseInt(but1.style.left) + parseInt(but1.style.minWidth) > parseInt(but2.style.left) 
			&& parseInt(but1.style.left) < parseInt(but2.style.left) +     parseInt(but2.style.minWidth)
			&& parseInt(but1.style.top) +  parseInt(but1.style.minHeight)> parseInt(but2.style.top)  
			&& parseInt(but1.style.top)  < parseInt(but2.style.top) +      parseInt(but2.style.minHeight))
			{
				return true;
			}
		return false;
	}
	
	function repel(but1, but2)
	{
		if(parseInt(but1.style.top) - parseInt(but1.style.minHeight) < 0)
		{
			but1.style.top = (parseInt(but1.style.top) + 1) + "px";
		} 
		else if(parseInt(but1.style.left) < parseInt(but1.style.minWidth))
		{
			but1.style.left = (parseInt(but1.style.left) + 1) + "px";
		}
		else
		{
			if(parseInt(but1.style.top) < parseInt(but2.style.top))
			{
				but1.style.top = (parseInt(but1.style.top) - 1) + "px";
				but2.style.top = (parseInt(but2.style.top) + 1) + "px";
			}
			else
			{
				but1.style.top = (parseInt(but1.style.top) + 1) + "px";
				but2.style.top = (parseInt(but2.style.top) - 1) + "px";
			}
			if(parseInt(but1.style.left) < parseInt(but2.style.left))
			{
				but1.style.left = (parseInt(but1.style.left) + 1) + "px";
				but2.style.left = (parseInt(but2.style.left) - 1) + "px";
			}
			else
			{
				but1.style.left = (parseInt(but1.style.left) - 1) + "px";
				but2.style.left = (parseInt(but2.style.left) + 1) + "px";
			}
		}
	}
	
	function updateAverage()
	{
		let ws = (deadI / ((new Date().getTime() - startTime)/1000)).toFixed(2);
		let cs = (deadIChars / ((new Date().getTime() - startTime)/1000)).toFixed(2);
		document.getElementById("average").innerHTML = ws + " words/s (" + (ws*60).toFixed(0) + "/min)";
		document.getElementById("averageChars").innerHTML = cs + " character/s(" + (cs*60).toFixed(0) + "/min)";
		document.getElementById("combo").innerHTML = "COMBO: "  + combo.toFixed(1);
		document.getElementById("combo").style.fontSize = 20 + combo/2 + "px";
		document.getElementById("score").innerHTML = "SCORE: "  + displayScore.toFixed(1);
		document.getElementById("score").style.fontSize = 20 + displayScore/25 + "px";
	}
	
	function getButton(placeholder, min, x = 0, y = 0)
	{
		let but = document.createElement("button");
		but.setAttribute("id", maxI);
		but.innerHTML = placeholder;
		but.style.minWidth = String(min) + "px";
		but.style.minHeight = String(min) + "px";
		but.style.position = "absolute";
		but.style.left =  String(x) + "px";
		but.style.top =  String(y) + "px";
		but.style.borderRadius =  "100" + "%";
		but.style.outline = "none";
		but.style.backgroundColor = "#EEDFFF";
		but.style.fontSize = String(0.5 + (min / (30 * Math.sqrt(placeholder.length)))) + "em";
		<!-- but.setAttribute("onclick", "remove(this)"); -->
		if(palindrome(placeholder))
			but.style.color = "red";
		else
			but.style.color = "green",
		console.log(but);
		maxI++;
		return but;
	}
	
	function remove(o)
	{
		comboUp(1 + o.innerHTML.length*0.2);
		scoreAdd(1 + o.innerHTML.length*0.2 * combo);
		if(o.getAttribute("id") == "0")
		{
			if(inter == undefined)
			{
				inter = setInterval(draw, 30);
				startTime = new Date().getTime();
			}
		}
		if(parseInt(o.style.minHeight) > 50)
		{
			let text = makeid(parseInt(o.style.minHeight)/15);
			let text2 = makeid(parseInt(o.style.minHeight)/15);
			while(text == text2)
				text2 = makeid(parseInt(o.style.minHeight)/15);
			o.parentNode.appendChild(getButton(text, 
			parseInt(o.style.minHeight)/4*3, 
			parseInt(o.style.left) - (parseInt(o.style.minHeight)/4*3)/3, 
			parseInt(o.style.top) - (parseInt(o.style.minHeight)/4*3)/3));
			o.parentNode.appendChild(getButton(text2, 
			parseInt(o.style.minHeight)/4*3, 
			parseInt(o.style.left) + (parseInt(o.style.minHeight)/4*3)/3, 
			parseInt(o.style.top) + (parseInt(o.style.minHeight)/4*3)/3));
		}
		deadIChars += o.innerHTML.length;
		o.remove();
		deadI++;
	}
	
	function checkRemove(o, event)
	{	
		if(invalidKey(event))
			comboBreak();
		for(let i = 0; i < maxI; i++)
		{	
			let but = document.getElementById(String(i));
			if(but)
			{
				if(but.innerHTML.toLowerCase() == o.value.toLowerCase())
				{
					o.value = "";
					remove(but);
				}
			}
		}
	}
	
	function invalidKey(event)
	{
	
		console.log(event);
			
		let value = true;
		
		if(event.type=="keydown")
		{
			let t = "azertyuiopqsdfghjklmwxcvbnAZERTYUIOPQSDFGHJKLMWXCVBN";
			for(let i = 0; i < t.length; i++)
			{
				if(t[i] == event.key)
					value = false;
			}
		}
		else if(event.type == "input")
		{
			return false;
		}
		
		if(value == true)
			console.log("bad input");
		else
			console.log("good input");
		return value;
	}
	
	function comboBreak()
	{
		combo = 0;
	}
	
	function comboUp(value = 1)
	{
		combo += value;
	}
	
	function scoreAdd(value = 1)
	{
		score += value;
	}
	
	function palindrome(text)
	{
		let pal = text + " : ";
		let res = text.toUpperCase() == text.split("").reverse().join("").toUpperCase();
		
		if(res) return true;
		else return false;
	}
	
	function makeid(l) {
	   let result = words[parseInt(Math.random()*words.length)];
	   while(result.length > l*(3/2) || result.length < l *(2/3))
			result = words[parseInt(Math.random()*words.length)];
	   return result;
	}
</script>
</body>
</html>